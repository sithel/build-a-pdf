<!doctype html>
<html>
<head>
    <link rel="stylesheet" href="assets/styles.css">
    <title>Build-A-PDF</title>
    <!-- jsDelivr :: Sortable :: Latest (https://www.jsdelivr.com/package/npm/sortablejs) -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="src/pdf-lib.js"></script>
    <script src="src/jszip.js"></script>
    <script src="src/file-saver.js"></script>
    <script src="src/pdfBuilder.js"></script>
    <script src="src/uiHelpers.js"></script>
</head>
<body>
<script>
/* HOW TO USE myFunction from mymodule.js ??? */
</script>

<div class="intro">
<h2>PDF Picnic</h2>

It's easy

<br>
<h3> Step 1. Prepare your contributeion</h3>
Typeset a recipe. Typeset three! Submit a cover or weird book/food fan art or photos. What are <i>you</i> bringing to the potluck? 

<br>
<h3>Step 2. Load up your plate</h3>
All submissions are due by midnight, Saturday March 23rd (PST). Once they're turned in, I'll lay out the spread and you'll be able to select which pages/recipes and the order they go in to assemble your personal Renegade PDF Potluck typeset! 


<br>
<h3>Step 3. Potluck 'n Party!</h3>
Share your bound copy and/or freakish food creation on April 1st in celebration of Edible Book Day. In the week leading up to it, we'll have a couple cook 'n craft alongs. Just as a meal can be greatly enjoyed broken into several courses, so can a book be pleasantly crafted across several sessions. Monday for text block sewing while XXX prepares for us YYY. Wednesday for edge management. Trimming, sanding, any sort of decorations (headbands, painting, etc) are encouraged while AAA cooks up BBB. Finally on Friday we'll build our case and case in to completion while EEEE shows us how to cook FFFF. 

<br>
<h3>Step 4. Enjoy</h3>
Photos of this year's results will be shared and last year's winners announced! 
</div>


<input type="button" value="Preview!" id="report" onClick="buildThatPdf(sortable2.toArray(), true)">
<input type="button" value="Save!" id="report" onClick="buildThatPdf(sortable2.toArray(), false)">
Grab recipes on the left by their weird "squares on left" shape and drag them over to add to your book. Don't preview w/ an empty book, things will break.
<BR>

<div id="exampler">
<table>
  <tr><td>Staging</td><td>Book</td></tr>
  <tr style="vertical-align: top;"><td>
    <div id="example1" class="list-group col">
      <div class="list-group-item"> <!-- start -->
        <div class="dot-box">
          <div class="dot tag-a"></div><div class="dot tag-b"></div><div class="dot tag-c"></div>
        </div>
        <div class="deleter" onClick="deleteMe(this)">[X]</div>
        <div class="handle"></div>
        <div class="colors full"></div>
        <div class="colors partial"></div>
        <div class="colors black"></div>
        <div class="frame folio"></div>
        <div class="frame quarto"></div>
        <div class="frame sexto"></div>
        <div class="title">Ignore this</div>
        <div class="author">Debug header</div>
        <div class="category">sharks</div>
      </div> <!-- end -->
    </div>
  </td><td>
    <div id="example2" class="list-group col"></div>
  </td></tr>
</table>
</div>

<div class="pdf-controls">
  <div class="tag-control-box" id="tag-info-box">
    <input type="checkbox" id="enable-tag-a"  data-value="a" onClick="toggleTag(this)" checked>
    <label for="enable-tag-a"><div class="dot tag-a"></div> Fake label</label>
  </div>
  <div class="block-positioning">
    Horizontal page content positioning : 
    <select name="cars" id="horizontal_page_positioning">
      <option value="inner">snug against binding</option>
      <option value="center">centered</option>
      <option value="outer">snug against fore edge</option>
    </select> <br/>

    Vertical page content positioning : 
    <select name="cars" id="vertical_page_positioning">
      <option value="top">snug against header</option>
      <option value="center">centered</option>
      <option value="bottom">snug against bottom</option>
    </select> <br/>

    Verso header : 
    <select name="cars" id="verso_header">
      <option value="title">title</option>
      <option value="nothing">nothing</option>
      <option value="section">section name</option>
    </select> <br/>

    Recto header : 
    <select name="cars" id="recto_header">
      <option value="section">section name</option>
      <option value="title">title</option>
      <option value="nothing">nothing</option>
    </select> <br/>
  </div>
</div>

<div class="pdf-preview-frame">
  <div>Preview</div>
  <iframe id="pdf" style="width: 100%; height: 10px; display: none"></iframe>
</div>



<script language="javascript">
  var tags = [
    { value: "a", label: "Vegetarian" },
    { value: "b", label: "Vegan" },
    { value: "c", label: "Lactose Free" },
    { value: "d", label: "Spicy" },
  ]
  var tagInfoBox = document.getElementById('tag-info-box');
  console.log("infobox? ",tagInfoBox)
  var z = tags.reduce((acc, tag) => {
    var v = tag.value;
    var s = `
  <input type="checkbox" id="enable-tag-`+v+`"  data-value="`+v+`" onClick="toggleTag(this)" checked>
  <label for="enable-tag-`+v+`"><div class="dot tag-`+v+`"></div>&nbsp;`+tag.label+`</label>
`
    console.log("Rebecca : ",s)
    return acc + s
  }, "Filter <b>Staging</b> content by tags: ");
  console.log("And done w/ ",z)
  tagInfoBox.innerHTML = z;
</script>


<script type="text/javascript">
  var el1 = document.getElementById('example1');
  var data = [
    {type: 'header', value: 'dessert', label: 'Desserts', entries: [
      ['Test 1', 'pdfs/sample_page_1.pdf', 'six', new Set(['a','b','c'])],
      ['Test 2', 'pdfs/sample_page_2.pdf', 'six', new Set(['a','c'])],
      ['Cookie 1', 'pdfs/cookie_1.pdf', 'suko', new Set(['b'])],
      ['Cookie 2', 'pdfs/cookie_2.pdf', 'suko', new Set(['b','c'])],
    ]},
    {type: 'header', value: 'main', label: 'Mains', entries: [
      ['RemedialJediTheology_TestPages_002', 'pdfs/RemedialJediTheology_TestPages_002 - AetherSeer.pdf', 'AetherSeer', new Set()],
      ['UrbeAurea_TestPages_001', 'pdfs/UrbeAurea_TestPages_001 - AetherSeer.pdf', 'AetherSeer', new Set()],
      ['UrbeAurea_TestPages_002', 'pdfs/UrbeAurea_TestPages_002 - AetherSeer.pdf', 'AetherSeer', new Set('b')],
      ]}
  ]
  data.forEach( d => {
    buildHeader(d.value, d.label, el1);
    buildPdfEntries(d.entries, d.value, el1);
  })

  function deleteMe(xButton) {
    var rowToKill = xButton.parentElement
    rowToKill.parentElement.removeChild(rowToKill)
  }

  function makeOptions(tagName) {
    return {
      group: "a-b",
      filter: ".ignore-elements",  // Selectors that do not lead to dragging (String or Function)
      handle: ".handle",  // Drag handle selector within list items
      chosenClass: "sortable-chosen",  // Class name for the chosen item
      dragClass: "sortable-drag",  // Class name for the dragging item
      dataIdAttr: 'data-id',
      animation: 150,
      onUpdate: function() {
        console.log( tagName+" UPDATE "+ this.toArray() );
      },
      onEnd: function() {
        console.log(tagName+" END "+ this.toArray() );
      },
      // Element is removed from the list into another list
      onRemove: function (/**Event*/evt) {
        console.log(tagName+" REMOVE "+ this.toArray() );
      },
      // Element is dropped into the list from another list
      onAdd: function (/**Event*/evt) {
        console.log(tagName+" ADD "+ this.toArray() );
      },
    }
  }
  var sortable1 = new Sortable(el1, makeOptions("list1"));
  var el2 = document.getElementById('example2');
  var sortable2 = new Sortable(el2, makeOptions("list2"));
</script>
</body>
</html>
